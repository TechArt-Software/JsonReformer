"use strict";var h=Object.defineProperty;var A=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var T=Object.prototype.hasOwnProperty;var E=(t,e)=>{for(var a in e)h(t,a,{get:e[a],enumerable:!0})},$=(t,e,a,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of x(e))!T.call(t,n)&&n!==a&&h(t,n,{get:()=>e[n],enumerable:!(r=A(e,n))||r.enumerable});return t};var b=t=>$(h({},"__esModule",{value:!0}),t);var U={};E(U,{ObjectReformer:()=>F,ParseModel:()=>O});module.exports=b(U);function v(t,e,a){let r=t;try{let n=e.split(".");return n.forEach((o,s)=>{var c,u,f,d;let i=o.match(/(.+?)\[(\d+)]/);if(i){let[B,y,g]=i,m=Number(g);if((c=r[y])!=null||(r[y]=[]),!Array.isArray(r[y]))throw new Error(`${y} is not an array`);r=s===n.length-1?r[y][m]=a:(f=(u=r[y])[m])!=null?f:u[m]={}}else r=s===n.length-1?r[o]=a:(d=r[o])!=null?d:r[o]={}}),null}catch(n){return n}}var p=v;function I(t,e){let a=e.split("."),r=t;for(let n of a){let o=n.match(/(.+?)\[(\d+)]/);if(o){let s=o[1],i=parseInt(o[2],10);if(r=r[s],!Array.isArray(r))throw new Error(`${s} is not an array`);r=r[i]}else r=r[n];if(r===void 0)throw new Error(`Key path "${e}" does not exist`)}return r}var l=I;function R(t,e,a,r){try{let n=e.replace(/\[(\d+)]/g,".$1").split(".").map(s=>/^\d+$/.test(s)?`[${s}]`:`.${s}`).join("").replace(/^\./,"");if(!r||r.length===0)throw new Error("Scripts array is undefined or empty");let o=l(t,n);return r==null||r.forEach(({action:s,parameters:i,body:c})=>{let f=new Function("input","property","currentValue","newValue",c)(t,n,o,a);p(t,e,f)}),null}catch(n){return n}}var P=R;Array.prototype.select||(Array.prototype.select=function(t){return this.map(t)});Array.prototype.where||(Array.prototype.where=function(t){return this.filter(t)});Array.prototype.orderBy||(Array.prototype.orderBy=function(t){return[...this].sort((e,a)=>{let r=t(e),n=t(a);for(let o=0;o<Math.max(r.length,n.length);o++){let s=r[o],i=n[o];if(s!==i)return s<i?-1:1}return 0})});function M(t,e){return new Function("arr","return arr"+e+";")(t)}function S(t,e,a){try{let r=e.replace(/\[(\d+)]/g,".$1").split(".").map(o=>/^\d+$/.test(o)?`[${o}]`:`.${o}`).join("").replace(/^\./,"");if(!a||a.length===0)throw new Error("Scripts array is undefined or empty");let n=l(t,r);return a==null||a.forEach(({action:o,parameters:s,body:i})=>{let c=M(n,i);p(t,e,c)}),null}catch(r){return r}}var j=t=>{let e=t;return{reform:(r,n,o)=>{var c;let s=r[o],i=(c=r.scripts)!=null?c:e;if(i){switch(i[0].action.toLowerCase()){case"filter":return S(n,o,i);default:break}return P(n,o,s,i)}return p(n,o,s)}}},w=j;var F=t=>{let e=t,a=new Map,{reform:r}=w(t.scripts);return{reform:o=>{try{if(!o)throw new Error("Invalid input");for(let s of e.reformers){let i=Object.keys(s)[0];if(a.has(i))continue;let c=r(s,o,i);a.set(i,c)}return o}catch(s){throw new Error(`Invalid JSON input:  ${s.message}`)}},status:a}};var O=t=>{let e=t.trim(),a=e.search(/[\{\[]/),r=Math.max(e.lastIndexOf("}"),e.lastIndexOf("]"));if(a===-1||r===-1)throw new Error("Invalid JSON structure.");return e.substring(a,r+1).replace(/"((?:\\.|[^"\\])*)"/g,(s,i)=>{let c=i.replace(/\n\s*/g," ");return c=c.replace(/\s{2,}/g," "),c=c.trim(),`"${c}"`})};0&&(module.exports={ObjectReformer,ParseModel});
//# sourceMappingURL=index.cjs.map