function g(e,n,a){let r=e;try{let o=n.split(".");return o.forEach((t,s)=>{var c,u,f,h;let i=t.match(/(.+?)\[(\d+)]/);if(i){let[$,y,w]=i,m=Number(w);if((c=r[y])!=null||(r[y]=[]),!Array.isArray(r[y]))throw new Error(`${y} is not an array`);r=s===o.length-1?r[y][m]=a:(f=(u=r[y])[m])!=null?f:u[m]={}}else r=s===o.length-1?r[t]=a:(h=r[t])!=null?h:r[t]={}}),null}catch(o){return o}}var p=g;function A(e,n){let a=n.split("."),r=e;for(let o of a){let t=o.match(/(.+?)\[(\d+)]/);if(t){let s=t[1],i=parseInt(t[2],10);if(r=r[s],!Array.isArray(r))throw new Error(`${s} is not an array`);r=r[i]}else r=r[o];if(r===void 0)throw new Error(`Key path "${n}" does not exist`)}return r}var l=A;function x(e,n,a,r){try{let o=n.replace(/\[(\d+)]/g,".$1").split(".").map(s=>/^\d+$/.test(s)?`[${s}]`:`.${s}`).join("").replace(/^\./,"");if(!r||r.length===0)throw new Error("Scripts array is undefined or empty");let t=l(e,o);return r==null||r.forEach(({action:s,parameters:i,body:c})=>{let f=new Function("input","property","currentValue","newValue",c)(e,o,t,a);p(e,n,f)}),null}catch(o){return o}}var d=x;Array.prototype.select||(Array.prototype.select=function(e){return this.map(e)});Array.prototype.where||(Array.prototype.where=function(e){return this.filter(e)});Array.prototype.orderBy||(Array.prototype.orderBy=function(e){return[...this].sort((n,a)=>{let r=e(n),o=e(a);for(let t=0;t<Math.max(r.length,o.length);t++){let s=r[t],i=o[t];if(s!==i)return s<i?-1:1}return 0})});function T(e,n){return new Function("arr","return arr"+n+";")(e)}function P(e,n,a){try{let r=n.replace(/\[(\d+)]/g,".$1").split(".").map(t=>/^\d+$/.test(t)?`[${t}]`:`.${t}`).join("").replace(/^\./,"");if(!a||a.length===0)throw new Error("Scripts array is undefined or empty");let o=l(e,r);return a==null||a.forEach(({action:t,parameters:s,body:i})=>{let c=T(o,i);p(e,n,c)}),null}catch(r){return r}}var E=e=>{let n=e;return{reform:(r,o,t)=>{var c;let s=r[t],i=(c=r.scripts)!=null?c:n;if(i){switch(i[0].action.toLowerCase()){case"filter":return P(o,t,i);default:break}return d(o,t,s,i)}return p(o,t,s)}}},S=E;var G=e=>{let n=e,a=new Map,{reform:r}=S(e.scripts);return{reform:t=>{try{if(!t)throw new Error("Invalid input");for(let s of n.reformers){let i=Object.keys(s)[0];if(a.has(i))continue;let c=r(s,t,i);a.set(i,c)}return t}catch(s){throw new Error(`Invalid JSON input:  ${s.message}`)}},status:a}};var q=e=>{let n=e.trim(),a=n.search(/[\{\[]/),r=Math.max(n.lastIndexOf("}"),n.lastIndexOf("]"));if(a===-1||r===-1)throw new Error("Invalid JSON structure.");return n.substring(a,r+1).replace(/"((?:\\.|[^"\\])*)"/g,(s,i)=>{let c=i.replace(/\n\s*/g," ");return c=c.replace(/\s{2,}/g," "),c=c.trim(),`"${c}"`})};export{G as ObjectReformer,q as ParseModel};
//# sourceMappingURL=index.js.map